<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Installing Custom Software | RCE Quick-Start Guide</title>
  <meta name="description" content="This is a guide for performing research on the RCE" />
  <meta name="generator" content="bookdown 0.12.2 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Installing Custom Software | RCE Quick-Start Guide" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a guide for performing research on the RCE" />
  <meta name="github-repo" content="IQSS/dss-rce" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Installing Custom Software | RCE Quick-Start Guide" />
  
  <meta name="twitter:description" content="This is a guide for performing research on the RCE" />
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="batch-job-examples.html"/>

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">RCE quick-start guide</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>What is the RCE?</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#authors"><i class="fa fa-check"></i>Authors</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="rce-setup.html"><a href="rce-setup.html"><i class="fa fa-check"></i><b>1</b> RCE Setup</a><ul>
<li class="chapter" data-level="1.1" data-path="rce-setup.html"><a href="rce-setup.html#access"><i class="fa fa-check"></i><b>1.1</b> Access</a></li>
<li class="chapter" data-level="1.2" data-path="rce-setup.html"><a href="rce-setup.html#compute-nodes"><i class="fa fa-check"></i><b>1.2</b> Compute nodes</a></li>
<li class="chapter" data-level="1.3" data-path="rce-setup.html"><a href="rce-setup.html#project-folders-shared-space"><i class="fa fa-check"></i><b>1.3</b> Project folders &amp; shared space</a></li>
<li class="chapter" data-level="1.4" data-path="rce-setup.html"><a href="rce-setup.html#moving-your-data-on-and-off"><i class="fa fa-check"></i><b>1.4</b> Moving your data on and off</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="interactive-jobs.html"><a href="interactive-jobs.html"><i class="fa fa-check"></i><b>2</b> Interactive Jobs</a><ul>
<li class="chapter" data-level="2.1" data-path="interactive-jobs.html"><a href="interactive-jobs.html#launching-applications"><i class="fa fa-check"></i><b>2.1</b> Launching applications</a></li>
<li class="chapter" data-level="2.2" data-path="interactive-jobs.html"><a href="interactive-jobs.html#available-applications"><i class="fa fa-check"></i><b>2.2</b> Available applications</a></li>
<li class="chapter" data-level="2.3" data-path="interactive-jobs.html"><a href="interactive-jobs.html#using-multiple-cpus"><i class="fa fa-check"></i><b>2.3</b> Using multiple CPUs</a><ul>
<li class="chapter" data-level="2.3.1" data-path="interactive-jobs.html"><a href="interactive-jobs.html#r"><i class="fa fa-check"></i><b>2.3.1</b> R</a></li>
<li class="chapter" data-level="2.3.2" data-path="interactive-jobs.html"><a href="interactive-jobs.html#python"><i class="fa fa-check"></i><b>2.3.2</b> Python</a></li>
<li class="chapter" data-level="2.3.3" data-path="interactive-jobs.html"><a href="interactive-jobs.html#other-languages"><i class="fa fa-check"></i><b>2.3.3</b> Other languages</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="batch-jobs.html"><a href="batch-jobs.html"><i class="fa fa-check"></i><b>3</b> Batch Jobs</a><ul>
<li class="chapter" data-level="3.1" data-path="batch-jobs.html"><a href="batch-jobs.html#preparing-a-batch-submission"><i class="fa fa-check"></i><b>3.1</b> Preparing a batch submission</a></li>
<li class="chapter" data-level="3.2" data-path="batch-jobs.html"><a href="batch-jobs.html#submit-file-overview"><i class="fa fa-check"></i><b>3.2</b> Submit file overview</a></li>
<li class="chapter" data-level="3.3" data-path="batch-jobs.html"><a href="batch-jobs.html#monitoring-and-managing"><i class="fa fa-check"></i><b>3.3</b> Monitoring and managing</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="batch-job-examples.html"><a href="batch-job-examples.html"><i class="fa fa-check"></i><b>4</b> Batch Job Examples</a><ul>
<li class="chapter" data-level="4.1" data-path="batch-job-examples.html"><a href="batch-job-examples.html#r-1"><i class="fa fa-check"></i><b>4.1</b> R</a><ul>
<li class="chapter" data-level="4.1.1" data-path="batch-job-examples.html"><a href="batch-job-examples.html#power-simulation"><i class="fa fa-check"></i><b>4.1.1</b> Power simulation</a></li>
<li class="chapter" data-level="4.1.2" data-path="batch-job-examples.html"><a href="batch-job-examples.html#varying-parameters"><i class="fa fa-check"></i><b>4.1.2</b> Varying parameters</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="batch-job-examples.html"><a href="batch-job-examples.html#python-1"><i class="fa fa-check"></i><b>4.2</b> Python</a><ul>
<li class="chapter" data-level="4.2.1" data-path="batch-job-examples.html"><a href="batch-job-examples.html#power-simulation-1"><i class="fa fa-check"></i><b>4.2.1</b> Power simulation</a></li>
<li class="chapter" data-level="4.2.2" data-path="batch-job-examples.html"><a href="batch-job-examples.html#varying-parameters-1"><i class="fa fa-check"></i><b>4.2.2</b> Varying parameters</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="batch-job-examples.html"><a href="batch-job-examples.html#stata"><i class="fa fa-check"></i><b>4.3</b> Stata</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="installing-custom-software.html"><a href="installing-custom-software.html"><i class="fa fa-check"></i><b>5</b> Installing Custom Software</a><ul>
<li class="chapter" data-level="5.1" data-path="installing-custom-software.html"><a href="installing-custom-software.html#conda-environments"><i class="fa fa-check"></i><b>5.1</b> Conda environments</a></li>
<li class="chapter" data-level="5.2" data-path="installing-custom-software.html"><a href="installing-custom-software.html#conda-setup"><i class="fa fa-check"></i><b>5.2</b> Conda setup</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">RCE Quick-Start Guide</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="installing-custom-software" class="section level1">
<h1><span class="header-section-number">5</span> Installing Custom Software</h1>
<div id="conda-environments" class="section level2">
<h2><span class="header-section-number">5.1</span> Conda environments</h2>
<p>The RCE is a shared resource that is actively administered to keep the cluster stable for all users. System administrators install and update software system-wide, while avoiding conflicts between software dependencies. It is not possible for RCE users to install software system-wide. However, users can install custom software into their own <em>project shared space</em> if the required dependencies are already installed system-wide, or if the dependencies can also be installed into the same project space. Frequently, however, it is not possible to manually install the full suite of required software dependencies (the ‘dependency tree’) for a given program.</p>
<p>A solution to this problem is to use <a href="https://docs.conda.io/projects/conda/en/latest/user-guide/concepts/environments.html">Conda environments</a>, which are siloed containers that can be used to install software - and their dependencies - without affecting other users on the cluster. Since Conda is a <a href="https://en.wikipedia.org/wiki/Package_manager">package management system</a>, it automatically handles the issue of installing appropriately versioned dependencies for any software you install.</p>
<p>A useful resource for interacting with Conda environments will be this <a href="https://docs.conda.io/projects/conda/en/4.6.0/_downloads/52a95608c49671267e40c689e0bc00ca/conda-cheatsheet.pdf">cheatsheet</a>.</p>
</div>
<div id="conda-setup" class="section level2">
<h2><span class="header-section-number">5.2</span> Conda setup</h2>
<p>Here, we walk through the steps needed to create a Conda enviroment in your <em>project space</em> on the RCE.</p>
<ol style="list-style-type: decimal">
<li>Start an RCE powered Anaconda shell.</li>
<li>Check which shell is being used and change shell to <code>bash</code> if necessary.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">$</span><span class="st"> </span>echo <span class="op">$</span><span class="dv">0</span>
<span class="op">$</span><span class="st"> </span><span class="er">/</span>bin<span class="op">/</span>bash <span class="co"># change to bash</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Create a new empty Conda environment in the home directory. The <code>-n</code> option indicates the environment name comes next. After the environment name, package names (possibly multiple, separated by a space) to be installed can be listed.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">$</span><span class="st"> </span>conda create <span class="op">-</span>n <span class="op">&lt;</span>name<span class="op">-</span>of<span class="op">-</span>environment<span class="op">&gt;</span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>Make sure there is enough room in the project space to store the <code>.conda</code> folder.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">$</span><span class="st"> </span>quotareport <span class="op">~</span><span class="er">/</span>shared_space<span class="op">/</span><span class="er">&lt;</span>user<span class="op">-</span>name<span class="op">&gt;</span></code></pre></div>
<ol start="5" style="list-style-type: decimal">
<li>Once the Conda environment is configured, use <code>rsync</code> to move (NOTE: do not use <code>mv</code> or <code>cp</code>) the <code>.conda</code> hidden directory from the home directory to a new directory (e.g., called <code>conda</code>) in the project space. Then delete the old <code>.conda</code> hidden directory within the home directory.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">$</span><span class="st"> </span>rsync <span class="op">-</span>rav <span class="op">~</span><span class="er">/</span>.conda <span class="op">~</span><span class="er">/</span>shared_space<span class="op">/</span><span class="er">&lt;</span>user<span class="op">-</span>name<span class="op">&gt;</span><span class="er">/</span>conda
<span class="op">$</span><span class="st"> </span>rm <span class="op">-</span>r <span class="op">~</span><span class="er">/</span>.conda</code></pre></div>
<ol start="6" style="list-style-type: decimal">
<li>Create a symbolic link (symlink) to the new directory from the original location (in the home directory). The <code>-s</code> option specifies a symlink, then the new directory is specified, then the previous location of the <code>.conda</code> folder in the home directory.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">$</span><span class="st"> </span>ln <span class="op">-</span>s <span class="op">~</span><span class="er">/</span>shared_space<span class="op">/</span><span class="er">&lt;</span>user<span class="op">-</span>name<span class="op">&gt;</span><span class="er">/</span>conda<span class="op">/</span>.conda <span class="op">~</span><span class="er">/</span>.conda</code></pre></div>
<ol start="7" style="list-style-type: decimal">
<li>View list of available Conda environments to check the symlink worked.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">$</span><span class="st"> </span>conda env list</code></pre></div>
<ol start="8" style="list-style-type: decimal">
<li>Search for program(s) to install. (optional)</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">$</span><span class="st"> </span>conda search “<span class="op">*</span>rstan<span class="op">*</span>”
<span class="op">$</span><span class="st"> </span>conda search “<span class="op">*</span>rstudio<span class="op">*</span>”</code></pre></div>
<ol start="9" style="list-style-type: decimal">
<li>Initiate the environment.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">$</span><span class="st"> </span>source activate <span class="op">&lt;</span>name<span class="op">-</span>of<span class="op">-</span>environment<span class="op">&gt;</span></code></pre></div>
<ol start="10" style="list-style-type: decimal">
<li>Install new programs into this active environment.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">$</span><span class="st"> </span>conda install r<span class="op">-</span>rstan rstudio</code></pre></div>
<ol start="11" style="list-style-type: decimal">
<li>Check where program(s) are installed and which version. (optional)</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">$</span><span class="st"> </span>which R
<span class="op">$</span><span class="st"> </span>which python
<span class="op">$</span><span class="st"> </span>R <span class="op">--</span>version
<span class="op">$</span><span class="st"> </span>echo <span class="op">$</span>PATH</code></pre></div>
<ol start="12" style="list-style-type: decimal">
<li>Run a program.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">$</span><span class="st"> </span>R
<span class="op">$</span><span class="st"> </span>rstudio</code></pre></div>
<ol start="13" style="list-style-type: decimal">
<li>Deactivate environment after use.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">$</span><span class="st"> </span>source deactivate</code></pre></div>
<p><strong>NOTE:</strong> if you need to move your existing Conda environment directory to a different location, it’s best to remove the old <code>.conda</code> directory and start with a fresh one in the new location.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="batch-job-examples.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/IQSS/dss-rce/edit/master/conda.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["RCE.pdf", "RCE.epub"],
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

</body>

</html>
